<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <OutputType>Exe</OutputType>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <IsTrimmable>true</IsTrimmable>
    <VerifyReferenceTrimCompatibility>true</VerifyReferenceTrimCompatibility>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\twodog\twodog.csproj" />
    <ProjectReference Include="..\project\project.csproj" />
  </ItemGroup>

  <!-- For local development: skip native download and use local Godot build -->
  <PropertyGroup>
    <TwoDogSkipNativeDownload>true</TwoDogSkipNativeDownload>
    <GodotBinDir>$(MSBuildProjectDirectory)/../godot/bin/</GodotBinDir>
  </PropertyGroup>

  <!--
    Local development: Use editor dev build for BOTH Debug and Release.
    
    Why? template_release builds require a bundled .NET runtime (coreclr/monosgen),
    which is designed for exported games. For local development, we use the editor
    build which leverages the system's .NET SDK via hostfxr.
    
    For actual production releases, you would use dotnet publish with the appropriate
    runtime bundling configuration.
  -->
  <PropertyGroup>
    <TwoDogBuildType>editor</TwoDogBuildType>
    <TwoDogDevBuild>true</TwoDogDevBuild>
    <!-- Windows -->
    <TwoDogNativesLocalPath Condition="$([MSBuild]::IsOSPlatform('Windows'))">$(GodotBinDir)godot.windows.editor.dev.x86_64.shared_library.dll</TwoDogNativesLocalPath>
    <!-- Linux -->
    <TwoDogNativesLocalPath Condition="$([MSBuild]::IsOSPlatform('Linux'))">$(GodotBinDir)libgodot.linuxbsd.editor.dev.x86_64.shared_library.so</TwoDogNativesLocalPath>
    <!-- macOS -->
    <TwoDogNativesLocalPath Condition="$([MSBuild]::IsOSPlatform('OSX'))">$(GodotBinDir)libgodot.macos.editor.dev.x86_64.shared_library.dylib</TwoDogNativesLocalPath>
  </PropertyGroup>

  <!-- Import twodog targets for GodotSharp API assembly copying -->
  <Import Project="..\twodog\build\twodog.targets" />

  <Target Name="DeepClean" AfterTargets="Clean">
    <RemoveDir Directories="$(BaseIntermediateOutputPath)" />
    <RemoveDir Directories="$(BaseOutputPath)" />
  </Target>
</Project>
